/*! ng-roundabout by Adam Timberlake <adam.timberlake@gmail.com> created on 2015-02-12 */
!function(a,b,c){"use strict";var d=a.module("ngRoundabout",[]).run(function(){a.isDefined(c)&&c.addTest("preserve3d",c.testAllProps("transformStyle","preserve-3d"))});d.constant("roundaboutOptions",{DIMENSION_WIDTH:250,DIMENSION_HEIGHT:300,DIMENSION_SPACING:10,PERSPECTIVE:1e3,TRANSLATE_Z:-2e3,BACKFACE_VISIBILITY:"hidden",MAINTAIN_ASPECT_RATIO:!1,FIGURE_PARTIAL_PATH:"partials/roundabout.html"}),d.directive("roundabout",["$window","roundaboutOptions",function(d,e){return{restrict:"EA",require:"ngModel",template:'<div class="container"><figure ng-repeat="model in collection" ng-include="partial">{{applyFigureElementStyles($index)}}</figure></div>',scope:{collection:"=ngModel",dimension:"=dimension"},controller:["$scope",function(b){b.currentDimensionWidth=0,b.memorisedOptions=!1,b.originalCount=0,b.partial=e.FIGURE_PARTIAL_PATH,b.applyBaseElementStyles=function(a){return a.css({width:e.DIMENSION_WIDTH+"px",height:e.DIMENSION_HEIGHT+"px",perspective:e.PERSPECTIVE+"px"})},b.applyContainerElementStyles=function(a,b){return b=null!==e.TRANSLATE_Z?e.TRANSLATE_Z:b,a.css({transform:"translateZ("+b+"px) rotateY(0deg)"})},b.applyFigureElementStyles=function(c,d){d=!!d||!1;var f=a.element(b.baseElement.find("figure")[c]),g=b.dimensionDegree*c;return f.css({width:b.currentDimensionWidth-e.DIMENSION_SPACING+"px",height:e.DIMENSION_HEIGHT+"px",transform:"rotateY("+g+"deg) translateZ("+b.translateZ+"px)",backfaceVisibility:e.BACKFACE_VISIBILITY}),d?f:void 0},b.supports3DTransforms=function(){return a.isDefined(c)?c.preserve3d:null},b.applyContainerElementOffset=function(a){a.css({left:"-"+(b.currentDimensionWidth-e.DIMENSION_WIDTH)/2+"px"})},b.getContainerElement=function(b){return a.element(b.find("div")[0])}}],link:function(c,d){d.addClass("carousel"),d.addClass("base"),c.currentDimensionWidth=e.DIMENSION_WIDTH,c.$watch("dimension",function(){var b=c.dimensionDegree*c.dimension;if(a.isNumber(b)){var f=c.getContainerElement(d),g=null!==e.TRANSLATE_Z?e.TRANSLATE_Z:0;f.css({transform:"translateZ("+g+"px) rotateY("+b+"deg)"})}}),c.$watchCollection("collection",function(){if(0!==c.collection.length){var a=c.collection.length,f=360/a,g=e.DIMENSION_WIDTH/2,h=b.round(g/b.tan(b.PI/a));c.translateZ=h,c.baseElement=d,c.dimensionDegree=f,c.memorisedOptions||(c.originalCount=c.collection.length,c.originalTranslateZ=h,c.memorisedOptions=!0);var i=c.getContainerElement(d);c.applyBaseElementStyles(d),c.applyContainerElementStyles(i,h),e.MAINTAIN_ASPECT_RATIO&&(c.translateZ=c.originalTranslateZ,c.currentDimensionWidth=e.DIMENSION_WIDTH*c.originalCount/a,c.applyContainerElementOffset(i))}})}}}])}(window.angular,window.Math,window.Modernizr);